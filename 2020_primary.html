<!DOCTYPE html>
<html>
<head>
    <title>Teacher's Union Sweeps School Board Election</title>
    <link href="styles/style.css" type="text/css"
      rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=EB+Garamond|Quattrocento&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
</head>
<body>
  <div class="topnav">
    <div class="topnav-body">
    <a class="name" href="index.html">Spencer Schien</a>
    <a class="active" href="2020_primary.html">Maps</a>
  </div>
  </div>
  <div class="page">
  <div class="copy">
    <h1>Teacher's Union Sweeps School Board Election</h1>
  <aside>
    And why not one more test for good measure.
  </aside>
  <p>
    This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.This is a test.
  This is a test.This is a test.This is a test.This is a test.This is a test.
This is a test.This is a test.This is a test.
</p>
<p>This is another test.</p>


    <script>
    var width = 900;
    var height = 850;

    var svg = d3.select( "body" )
        .append( "svg" )
        .attr( "width", width )
        .attr( "height", height );

    var albersProjection = d3.geoAlbers()
        .scale( 175000 )
        .center([0, 43.06])
        .rotate([87.971, 0])
        .translate( [width/2,height/2] );

    var geoPath = d3.geoPath()
        .projection( albersProjection );

    d3.queue()
      .defer(d3.json, "wards.geojson")
      .defer(d3.csv, "election_data.csv")
      .await(ready);

var color = d3.scaleLinear()
    .domain([-100, 0, 100])
    .range(["red", "lightgrey", "blue"])

function ready(error, wards, election) {
  if (error) throw error;

var rateBySway = {};
  election.forEach(function(d) {
    rateBySway[d.WARD] = +d.sway
  });

  svg.selectAll( "path" )
      .data( wards.features )
      .enter()
      .append( "path" )
      .attr( "fill", function(d) {
        return color(rateBySway[d.properties.WARD]);
      })
      .attr( "stroke", "white")
      .attr( "d", geoPath )
      .on("mouseover", function(d){
              d3.select(this)
              .attr("opacity", ".25");
              return tooltip.style("visibility", "visible")
                            .text("Ward: " + d.properties.WARD);
    	})
      .on("mousemove", function(d){
    		return tooltip.style("top", (d3.event.pageY-50)+"px")
        .style("left",(d3.event.pageX-37.5)+"px")
        .text("Ward: " + d.properties.WARD + " Sway: " +
        d3.format(".1f")(rateBySway[d.properties.WARD]) + "%");
    	})
    	.on("mouseout", function(d){
        d3.select(this)
        .attr("opacity", "1");
    		return tooltip.style("visibility", "hidden");
    	});

  var tooltip = d3.select("body")
    .append("div")
    .style("position", "absolute")
    .style("font-family", "'Open Sans', sans-serif")
    .style("font-size", "12px")
    .style("z-index", "10")
    .style("visibility", "hidden")
    .style("width", "75px")
    .style("height", "30px")
    .style("padding", "2px")
    .style("background", "white")
    .style("opacity", "0.9")
    .style("box-shadow", "0 1px 5px rgba(0, 0, 0, 0.4)")
    .style("border", "1px solid rgba(200, 200, 200, 0.85)");
}

d3.selectAll("svg")
.attr("align", "center");
    </script>
    <p>This is another test.</p>
  </div>
</div>
</body>
</html>
